{% extends 'base.html' %}
{% block title %}Dashboard{% endblock %}
{% block heading %}Dashboard{% endblock %}

{% block content %}
<!-- Filter Section -->
<div class="grid grid-cols-4 gap-4 mb-6">
    <div class="relative">
        <select class="select select-bordered w-full">
            <option>Select PowerPlant</option>
        </select>
    </div>
    <div class="relative">
        <select class="select select-bordered w-full">
            <option>Select Zone</option>
        </select>
    </div>
    <div class="relative">
        <select class="select select-bordered w-full">
            <option>Select Panel</option>
        </select>
    </div>
    <div class="relative">
        <div class="select select-bordered w-full flex items-center justify-between">
            <span class="text-sm">Today: Apr 25, 2018 12:00 AM - Apr 26, 2018 12:00 AM</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-down" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
            </svg>
        </div>
    </div>
</div>

<!-- Stats Cards -->
<div class="grid grid-cols-4 gap-6 mb-8">
    <div class="bg-white p-4 rounded-md shadow">
        <div class="flex items-center mb-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="text-gray-500 mr-2" viewBox="0 0 16 16">
                <path d="M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1h8Zm-7.978-1A.261.261 0 0 1 7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002a.274.274 0 0 1-.014.002H7.022ZM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM6.936 9.28a5.88 5.88 0 0 0-1.23-.247A7.35 7.35 0 0 0 5 9c-4 0-5 3-5 4 0 .667.333 1 1 1h4.216A2.238 2.238 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816ZM4.92 10A5.493 5.493 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0Zm3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z"/>
            </svg>
            <span class="text-gray-600">Total Users</span>
        </div>
        <div class="text-3xl font-bold mb-2">42</div>
        <div class="text-green-500 text-sm flex items-center">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="mr-1" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M8 12a.5.5 0 0 0 .5-.5V5.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 5.707V11.5a.5.5 0 0 0 .5.5z"/>
            </svg>
            <span>4.2% from last month</span>
        </div>
        <div class="mt-4 text-orange-500 flex items-center justify-end">
            <span class="text-sm">View detail</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="ml-1" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
            </svg>
        </div>
    </div>
    <div class="bg-white p-4 rounded-md shadow">
        <div class="flex items-center mb-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="text-gray-500 mr-2" viewBox="0 0 16 16">
                <path d="M11.251.068a.5.5 0 0 1 .227.58L9.677 6.5H13a.5.5 0 0 1 .364.843l-8 8.5a.5.5 0 0 1-.842-.49L6.323 9.5H3a.5.5 0 0 1-.364-.843l8-8.5a.5.5 0 0 1 .615-.09z"/>
            </svg>
            <span class="text-gray-600">Total Power</span>
        </div>
        <div class="text-3xl font-bold mb-2">1,000W</div>
        <div class="text-green-500 text-sm flex items-center">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="mr-1" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M8 12a.5.5 0 0 0 .5-.5V5.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 5.707V11.5a.5.5 0 0 0 .5.5z"/>
            </svg>
            <span>2.2% from last month</span>
        </div>
        <div class="mt-4 text-orange-500 flex items-center justify-end">
            <span class="text-sm">View detail</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="ml-1" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
            </svg>
        </div>
    </div>
    <div class="bg-white p-4 rounded-md shadow">
        <div class="flex items-center mb-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="text-gray-500 mr-2" viewBox="0 0 16 16">
                <path d="M2.5 15a.5.5 0 1 1 0-1h1v-1a4.5 4.5 0 0 1 2.557-4.06c.29-.139.443-.377.443-.59v-.7c0-.213-.154-.451-.443-.59A4.5 4.5 0 0 1 3.5 3V2h-1a.5.5 0 0 1 0-1h11a.5.5 0 0 1 0 1h-1v1a4.5 4.5 0 0 1-2.557 4.06c-.29.139-.443.377-.443.59v.7c0 .213.154.451.443.59A4.5 4.5 0 0 1 12.5 13v1h1a.5.5 0 0 1 0 1h-11zm2-13v1c0 .537.12 1.045.337 1.5h6.326c.216-.455.337-.963.337-1.5V2h-7zm3 6.35c0 .701-.478 1.236-1.011 1.492A3.5 3.5 0 0 0 4.5 13s.866-1.299 3-1.48V8.35zm1 0v3.17c2.134.181 3 1.48 3 1.48a3.5 3.5 0 0 0-1.989-3.158C8.978 9.586 8.5 9.052 8.5 8.351z"/>
            </svg>
            <span class="text-gray-600">Total Panel</span>
        </div>
        <div class="text-3xl font-bold mb-2">16</div>
        <div class="mt-4 text-orange-500 flex items-center justify-end">
            <span class="text-sm">View detail</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="ml-1" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
            </svg>
        </div>
    </div>
    <div class="bg-white p-4 rounded-md shadow">
        <div class="flex items-center mb-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="text-gray-500 mr-2" viewBox="0 0 16 16">
                <path d="M14.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h13zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-13z"/>
                <path d="M3 5.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zM3 8a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 8zm0 2.5a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5z"/>
            </svg>
            <span class="text-gray-600">Total Reports</span>
        </div>
        <div class="text-3xl font-bold mb-2">12</div>
        <div class="mt-4 text-orange-500 flex items-center justify-end">
            <span class="text-sm">View detail</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="ml-1" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
            </svg>
        </div>
    </div>
</div>

<!-- Powerplant Section -->
<div class="mb-8">
    <div class="flex justify-between items-center mb-4">
        <h2 class="text-lg font-semibold text-gray-800">Selected Powerplant</h2>
    </div>
    <div class="bg-white p-4 rounded-md shadow">
        <div class="border-b pb-4 flex">
            <button class="px-4 py-2 text-purple-600 border-b-2 border-purple-600 font-medium">Powerplant 1</button>
            <button class="px-4 py-2 text-gray-500">Powerplant 2</button>
            <button class="px-4 py-2 text-gray-500">Powerplant 3</button>
            <button class="px-4 py-2 text-gray-500">Powerplant 4</button>
            <button class="px-4 py-2 text-gray-500">Powerplant 5</button>
        </div>
        <div class="grid grid-cols-5 gap-4 py-4">
            <div class="text-center">
                <div class="text-xl font-bold">200W</div>
                <div class="text-green-500 text-sm">+3%</div>
            </div>
            <div class="text-center">
                <div class="text-xl font-bold">200W</div>
                <div class="text-green-500 text-sm">+3%</div>
            </div>
            <div class="text-center">
                <div class="text-xl font-bold">200W</div>
                <div class="text-green-500 text-sm">+3%</div>
            </div>
            <div class="text-center">
                <div class="text-xl font-bold">200W</div>
                <div class="text-green-500 text-sm">+3%</div>
            </div>
            <div class="text-center">
                <div class="text-xl font-bold">200W</div>
                <div class="text-green-500 text-sm">+3%</div>
            </div>
        </div>
        <div class="mt-4 relative" style="height: 300px;">
            <canvas id="powerplantChart"></canvas>
            <div id="powerplantLegend" class="absolute top-2 right-4 bg-gray-800 text-white p-3 rounded-md shadow-lg z-10"></div>
        </div>
    </div>
</div>

<!-- Hourly Report Section -->
<div>
    <div class="flex justify-between items-center mb-4">
        <h2 class="text-lg font-semibold text-gray-800">Hourly power report</h2>
        <a href="#" class="text-orange-500">View All</a>
    </div>
    <div class="bg-white p-4 rounded-md shadow">
        <div class="flex justify-between mb-4">
            <div class="relative w-40">
                <select class="select select-bordered w-full">
                    <option>Select PowerPlant</option>
                </select>
            </div>
            <div class="relative w-40">
                <select class="select select-bordered w-full">
                    <option>Day</option>
                </select>
            </div>
        </div>
        <div class="relative" style="height: 300px;">
            <canvas id="hourlyChart"></canvas>
            <div class="absolute top-4 right-10 bg-gray-800 text-white px-3 py-1 rounded-md z-10">2431</div>
        </div>
    </div>
</div>

<!-- Include Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Powerplant Chart
        const powerplantCtx = document.getElementById('powerplantChart').getContext('2d');
        const powerplantChart = new Chart(powerplantCtx, {
            type: 'line',
            data: {
                labels: ['Mon, 20', 'Tue, 21', 'Wed, 22', 'Thu, 23', 'Fri, 24', 'Sat, 25', 'Sun, 26', 'Mon, 27', 'Tue, 28'],
                datasets: [
                    {
                        label: 'Powerplant 1',
                        data: [150, 200, 250, 300, 280, 250, 220, 180, 150],
                        borderColor: '#a855f7', // Purple
                        tension: 0.4,
                        fill: false,
                        borderWidth: 3
                    },
                    {
                        label: 'Powerplant 2',
                        data: [200, 250, 300, 350, 330, 310, 290, 270, 250],
                        borderColor: '#ef4444', // Red
                        tension: 0.4,
                        fill: false,
                        borderWidth: 3
                    },
                    {
                        label: 'Powerplant 3',
                        data: [180, 230, 280, 330, 350, 340, 320, 300, 280],
                        borderColor: '#eab308', // Yellow
                        tension: 0.4,
                        fill: false,
                        borderWidth: 3
                    },
                    {
                        label: 'Powerplant 4',
                        data: [220, 270, 320, 370, 390, 380, 360, 340, 320],
                        borderColor: '#22c55e', // Green
                        tension: 0.4,
                        fill: false,
                        borderWidth: 3
                    },
                    {
                        label: 'Powerplant 5',
                        data: [120, 170, 220, 270, 290, 280, 260, 240, 220],
                        borderColor: '#3b82f6', // Blue
                        tension: 0.4,
                        fill: false,
                        borderWidth: 3
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false,
                        backgroundColor: '#1f2937',
                        titleColor: 'white',
                        bodyColor: 'white',
                        borderColor: '#374151',
                        borderWidth: 1,
                        padding: 10,
                        displayColors: true,
                        callbacks: {
                            label: function(context) {
                                return context.dataset.label + ': ' + context.parsed.y + 'W';
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: 'rgba(0, 0, 0, 0.05)'
                        },
                        ticks: {
                            callback: function(value) {
                                return value;
                            }
                        }
                    },
                    x: {
                        grid: {
                            color: 'rgba(0, 0, 0, 0.05)'
                        }
                    }
                },
                interaction: {
                    intersect: false,
                    mode: 'index'
                }
            }
        });

        // Create custom legend
        const legendContainer = document.getElementById('powerplantLegend');
        const legendItems = [
            { label: 'Powerplant 1', color: '#a855f7', value: '40' },
            { label: 'Powerplant 2', color: '#ef4444', value: '72' },
            { label: 'Powerplant 3', color: '#eab308', value: '68' },
            { label: 'Powerplant 4', color: '#22c55e', value: '80' },
            { label: 'Powerplant 5', color: '#3b82f6', value: '29' }
        ];
        
        legendItems.forEach((item, index) => {
            const itemDiv = document.createElement('div');
            itemDiv.classList.add('mb-2', 'flex', 'items-center');
            if (index === legendItems.length - 1) {
                itemDiv.classList.remove('mb-2');
            }
            
            itemDiv.innerHTML = `
                <span class="w-3 h-3 rounded-full inline-block mr-2" style="background-color: ${item.color}"></span>
                <span>${item.label}</span>
                <span class="ml-auto pl-4">${item.value}</span>
            `;
            
            legendContainer.appendChild(itemDiv);
        });

        // Hourly Chart
        const hourlyCtx = document.getElementById('hourlyChart').getContext('2d');
        const hourlyChart = new Chart(hourlyCtx, {
            type: 'bar',
            data: {
                labels: ['1-2AM', '2-3AM', '3-4AM', '4-5AM', '5-6AM', '6-7AM', '7-8AM', '8-9AM', '9-10AM', '10-11AM'],
                datasets: [{
                    label: 'Power (W)',
                    data: [1200, 1900, 1300, 1500, 2000, 2400, 2300, 2100, 1800, 5000],
                    backgroundColor: '#60a5fa',
                    borderColor: '#3b82f6',
                    borderWidth: 1,
                    borderRadius: 4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        backgroundColor: '#1f2937',
                        titleColor: 'white',
                        bodyColor: 'white',
                        borderColor: '#374151',
                        borderWidth: 1,
                        padding: 10
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: 'rgba(0, 0, 0, 0.05)'
                        },
                        ticks: {
                            callback: function(value) {
                                return value;
                            }
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        }
                    }
                }
            }
        });
    });
</script>
{% endblock %}
